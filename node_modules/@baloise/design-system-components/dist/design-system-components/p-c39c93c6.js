const t=Math.min,n=Math.max,e=Math.round,o=Math.floor,r=t=>({x:t,y:t}),i={left:"right",right:"left",bottom:"top",top:"bottom"},c={start:"end",end:"start"};function l(e,o,r){return n(e,t(o,r))}function a(t,n){return"function"==typeof t?t(n):t}function s(t){return t.split("-")[0]}function u(t){return t.split("-")[1]}function f(t){return"x"===t?"y":"x"}function d(t){return"y"===t?"height":"width"}function m(t){return["top","bottom"].includes(s(t))?"y":"x"}function y(t){return f(m(t))}function p(t){return t.replace(/start|end/g,(t=>c[t]))}function h(t){return t.replace(/left|right|bottom|top/g,(t=>i[t]))}function x(t){return"number"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function g(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function w(t,n,e){let{reference:o,floating:r}=t;const i=m(n),c=y(n),l=d(c),a=s(n),f="y"===i,p=o.x+o.width/2-r.width/2,h=o.y+o.height/2-r.height/2,x=o[l]/2-r[l]/2;let g;switch(a){case"top":g={x:p,y:o.y-r.height};break;case"bottom":g={x:p,y:o.y+o.height};break;case"right":g={x:o.x+o.width,y:h};break;case"left":g={x:o.x-r.width,y:h};break;default:g={x:o.x,y:o.y}}switch(u(n)){case"start":g[c]-=x*(e&&f?-1:1);break;case"end":g[c]+=x*(e&&f?-1:1)}return g}async function v(t,n){var e;void 0===n&&(n={});const{x:o,y:r,platform:i,rects:c,elements:l,strategy:s}=t,{boundary:u="clippingAncestors",rootBoundary:f="viewport",elementContext:d="floating",altBoundary:m=!1,padding:y=0}=a(n,t),p=x(y),h=l[m?"floating"===d?"reference":"floating":d],w=g(await i.getClippingRect({element:null==(e=await(null==i.isElement?void 0:i.isElement(h)))||e?h:h.contextElement||await(null==i.getDocumentElement?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:f,strategy:s})),v="floating"===d?{...c.floating,x:o,y:r}:c.reference,b=await(null==i.getOffsetParent?void 0:i.getOffsetParent(l.floating)),A=await(null==i.isElement?void 0:i.isElement(b))&&await(null==i.getScale?void 0:i.getScale(b))||{x:1,y:1},R=g(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({rect:v,offsetParent:b,strategy:s}):v);return{top:(w.top-R.top+p.top)/A.y,bottom:(R.bottom-w.bottom+p.bottom)/A.y,left:(w.left-R.left+p.left)/A.x,right:(R.right-w.right+p.right)/A.x}}const b=n=>({name:"arrow",options:n,async fn(e){const{x:o,y:r,placement:i,rects:c,platform:s,elements:f}=e,{element:m,padding:p=0}=a(n,e)||{};if(null==m)return{};const h=x(p),g={x:o,y:r},w=y(i),v=d(w),b=await s.getDimensions(m),A="y"===w,R=A?"top":"left",S=A?"bottom":"right",k=A?"clientHeight":"clientWidth",F=c.reference[v]+c.reference[w]-g[w]-c.floating[v],T=g[w]-c.reference[w],O=await(null==s.getOffsetParent?void 0:s.getOffsetParent(m));let P=O?O[k]:0;P&&await(null==s.isElement?void 0:s.isElement(O))||(P=f.floating[k]||c.floating[v]);const M=F/2-T/2,z=P/2-b[v]/2-1,C=t(h[R],z),D=t(h[S],z),L=C,B=P-b[v]-D,E=P/2-b[v]/2+M,I=l(L,E,B),N=null!=u(i)&&E!=I&&c.reference[v]/2-(E<L?C:D)-b[v]/2<0?E<L?L-E:B-E:0;return{[w]:g[w]-N,data:{[w]:I,centerOffset:E-I+N}}}}),A=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(n){var e;const{placement:o,middlewareData:r,rects:i,initialPlacement:c,platform:l,elements:f}=n,{mainAxis:m=!0,crossAxis:x=!0,fallbackPlacements:g,fallbackStrategy:w="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:A=!0,...R}=a(t,n),S=s(o),k=s(c)===c,F=await(null==l.isRTL?void 0:l.isRTL(f.floating)),T=g||(k||!A?[h(c)]:function(t){const n=h(t);return[p(t),n,p(n)]}(c));g||"none"===b||T.push(...function(t,n,e,o){const r=u(t);let i=function(t,n,e){const o=["left","right"],r=["right","left"],i=["top","bottom"],c=["bottom","top"];switch(t){case"top":case"bottom":return e?n?r:o:n?o:r;case"left":case"right":return n?i:c;default:return[]}}(s(t),"start"===e,o);return r&&(i=i.map((t=>t+"-"+r)),n&&(i=i.concat(i.map(p)))),i}(c,A,b,F));const O=[c,...T],P=await v(n,R),M=[];let z=(null==(e=r.flip)?void 0:e.overflows)||[];if(m&&M.push(P[S]),x){const t=function(t,n,e){void 0===e&&(e=!1);const o=u(t),r=y(t),i=d(r);let c="x"===r?o===(e?"end":"start")?"right":"left":"start"===o?"bottom":"top";return n.reference[i]>n.floating[i]&&(c=h(c)),[c,h(c)]}(o,i,F);M.push(P[t[0]],P[t[1]])}if(z=[...z,{placement:o,overflows:M}],!M.every((t=>t<=0))){var C,D;const t=((null==(C=r.flip)?void 0:C.index)||0)+1,n=O[t];if(n)return{data:{index:t,overflows:z},reset:{placement:n}};let e=null==(D=z.filter((t=>t.overflows[0]<=0)).sort(((t,n)=>t.overflows[1]-n.overflows[1]))[0])?void 0:D.placement;if(!e)switch(w){case"bestFit":{var L;const t=null==(L=z.map((t=>[t.placement,t.overflows.filter((t=>t>0)).reduce(((t,n)=>t+n),0)])).sort(((t,n)=>t[1]-n[1]))[0])?void 0:L[0];t&&(e=t);break}case"initialPlacement":e=c}if(o!==e)return{reset:{placement:e}}}return{}}}},R=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(n){const{x:e,y:o}=n,r=await async function(t,n){const{placement:e,platform:o,elements:r}=t,i=await(null==o.isRTL?void 0:o.isRTL(r.floating)),c=s(e),l=u(e),f="y"===m(e),d=["left","top"].includes(c)?-1:1,y=i&&f?-1:1,p=a(n,t);let{mainAxis:h,crossAxis:x,alignmentAxis:g}="number"==typeof p?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...p};return l&&"number"==typeof g&&(x="end"===l?-1*g:g),f?{x:x*y,y:h*d}:{x:h*d,y:x*y}}(n,t);return{x:e+r.x,y:o+r.y,data:r}}}},S=function(t){return void 0===t&&(t={}),{name:"shift",options:t,async fn(n){const{x:e,y:o,placement:r}=n,{mainAxis:i=!0,crossAxis:c=!1,limiter:u={fn:t=>{let{x:n,y:e}=t;return{x:n,y:e}}},...d}=a(t,n),y={x:e,y:o},p=await v(n,d),h=m(s(r)),x=f(h);let g=y[x],w=y[h];i&&(g=l(g+p["y"===x?"top":"left"],g,g-p["y"===x?"bottom":"right"])),c&&(w=l(w+p["y"===h?"top":"left"],w,w-p["y"===h?"bottom":"right"]));const b=u.fn({...n,[x]:g,[h]:w});return{...b,data:{x:b.x-e,y:b.y-o}}}}};function k(t){return O(t)?(t.nodeName||"").toLowerCase():"#document"}function F(t){var n;return(null==t||null==(n=t.ownerDocument)?void 0:n.defaultView)||window}function T(t){var n;return null==(n=(O(t)?t.ownerDocument:t.document)||window.document)?void 0:n.documentElement}function O(t){return t instanceof Node||t instanceof F(t).Node}function P(t){return t instanceof Element||t instanceof F(t).Element}function M(t){return t instanceof HTMLElement||t instanceof F(t).HTMLElement}function z(t){return"undefined"!=typeof ShadowRoot&&(t instanceof ShadowRoot||t instanceof F(t).ShadowRoot)}function C(t){const{overflow:n,overflowX:e,overflowY:o,display:r}=I(t);return/auto|scroll|overlay|hidden|clip/.test(n+o+e)&&!["inline","contents"].includes(r)}function D(t){return["table","td","th"].includes(k(t))}function L(t){const n=B(),e=I(t);return"none"!==e.transform||"none"!==e.perspective||!!e.containerType&&"normal"!==e.containerType||!n&&!!e.backdropFilter&&"none"!==e.backdropFilter||!n&&!!e.filter&&"none"!==e.filter||["transform","perspective","filter"].some((t=>(e.willChange||"").includes(t)))||["paint","layout","strict","content"].some((t=>(e.contain||"").includes(t)))}function B(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function E(t){return["html","body","#document"].includes(k(t))}function I(t){return F(t).getComputedStyle(t)}function N(t){return P(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function q(t){if("html"===k(t))return t;const n=t.assignedSlot||t.parentNode||z(t)&&t.host||T(t);return z(n)?n.host:n}function H(t){const n=q(t);return E(n)?t.ownerDocument?t.ownerDocument.body:t.body:M(n)&&C(n)?n:H(n)}function $(t,n){var e;void 0===n&&(n=[]);const o=H(t),r=o===(null==(e=t.ownerDocument)?void 0:e.body),i=F(o);return r?n.concat(i,i.visualViewport||[],C(o)?o:[],i.frameElement?$(i.frameElement):[]):n.concat(o,$(o))}function j(t){const n=I(t);let o=parseFloat(n.width)||0,r=parseFloat(n.height)||0;const i=M(t),c=i?t.offsetWidth:o,l=i?t.offsetHeight:r,a=e(o)!==c||e(r)!==l;return a&&(o=c,r=l),{width:o,height:r,$:a}}function V(t){return P(t)?t:t.contextElement}function W(t){const n=V(t);if(!M(n))return r(1);const o=n.getBoundingClientRect(),{width:i,height:c,$:l}=j(n);let a=(l?e(o.width):o.width)/i,s=(l?e(o.height):o.height)/c;return a&&Number.isFinite(a)||(a=1),s&&Number.isFinite(s)||(s=1),{x:a,y:s}}const X=r(0);function Y(t){const n=F(t);return B()&&n.visualViewport?{x:n.visualViewport.offsetLeft,y:n.visualViewport.offsetTop}:X}function _(t,n,e,o){void 0===n&&(n=!1),void 0===e&&(e=!1);const i=t.getBoundingClientRect(),c=V(t);let l=r(1);n&&(o?P(o)&&(l=W(o)):l=W(t));const a=function(t,n,e){return void 0===n&&(n=!1),!(!e||n&&e!==F(t))&&n}(c,e,o)?Y(c):r(0);let s=(i.left+a.x)/l.x,u=(i.top+a.y)/l.y,f=i.width/l.x,d=i.height/l.y;if(c){const t=F(c),n=o&&P(o)?F(o):o;let e=t.frameElement;for(;e&&o&&n!==t;){const t=W(e),n=e.getBoundingClientRect(),o=I(e),r=n.left+(e.clientLeft+parseFloat(o.paddingLeft))*t.x,i=n.top+(e.clientTop+parseFloat(o.paddingTop))*t.y;s*=t.x,u*=t.y,f*=t.x,d*=t.y,s+=r,u+=i,e=F(e).frameElement}}return g({width:f,height:d,x:s,y:u})}function G(t){return _(T(t)).left+N(t).scrollLeft}function J(t,e,o){let i;if("viewport"===e)i=function(t,n){const e=F(t),o=T(t),r=e.visualViewport;let i=o.clientWidth,c=o.clientHeight,l=0,a=0;if(r){i=r.width,c=r.height;const t=B();(!t||t&&"fixed"===n)&&(l=r.offsetLeft,a=r.offsetTop)}return{width:i,height:c,x:l,y:a}}(t,o);else if("document"===e)i=function(t){const e=T(t),o=N(t),r=t.ownerDocument.body,i=n(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),c=n(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let l=-o.scrollLeft+G(t);const a=-o.scrollTop;return"rtl"===I(r).direction&&(l+=n(e.clientWidth,r.clientWidth)-i),{width:i,height:c,x:l,y:a}}(T(t));else if(P(e))i=function(t,n){const e=_(t,!0,"fixed"===n),o=e.top+t.clientTop,i=e.left+t.clientLeft,c=M(t)?W(t):r(1);return{width:t.clientWidth*c.x,height:t.clientHeight*c.y,x:i*c.x,y:o*c.y}}(e,o);else{const n=Y(t);i={...e,x:e.x-n.x,y:e.y-n.y}}return g(i)}function K(t,n){const e=q(t);return!(e===n||!P(e)||E(e))&&("fixed"===I(e).position||K(e,n))}function Q(t,n,e){const o=M(n),i=T(n),c="fixed"===e,l=_(t,!0,c,n);let a={scrollLeft:0,scrollTop:0};const s=r(0);if(o||!o&&!c)if(("body"!==k(n)||C(i))&&(a=N(n)),o){const t=_(n,!0,c,n);s.x=t.x+n.clientLeft,s.y=t.y+n.clientTop}else i&&(s.x=G(i));return{x:l.left+a.scrollLeft-s.x,y:l.top+a.scrollTop-s.y,width:l.width,height:l.height}}function U(t,n){return M(t)&&"fixed"!==I(t).position?n?n(t):t.offsetParent:null}function Z(t,n){const e=F(t);if(!M(t))return e;let o=U(t,n);for(;o&&D(o)&&"static"===I(o).position;)o=U(o,n);return o&&("html"===k(o)||"body"===k(o)&&"static"===I(o).position&&!L(o))?e:o||function(t){let n=q(t);for(;M(n)&&!E(n);){if(L(n))return n;n=q(n)}return null}(t)||e}const tt={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:n,offsetParent:e,strategy:o}=t;const i=M(e),c=T(e);if(e===c)return n;let l={scrollLeft:0,scrollTop:0},a=r(1);const s=r(0);if((i||!i&&"fixed"!==o)&&(("body"!==k(e)||C(c))&&(l=N(e)),M(e))){const t=_(e);a=W(e),s.x=t.x+e.clientLeft,s.y=t.y+e.clientTop}return{width:n.width*a.x,height:n.height*a.y,x:n.x*a.x-l.scrollLeft*a.x+s.x,y:n.y*a.y-l.scrollTop*a.y+s.y}},getDocumentElement:T,getClippingRect:function(e){let{element:o,boundary:r,rootBoundary:i,strategy:c}=e;const l=[..."clippingAncestors"===r?function(t,n){const e=n.get(t);if(e)return e;let o=$(t).filter((t=>P(t)&&"body"!==k(t))),r=null;const i="fixed"===I(t).position;let c=i?q(t):t;for(;P(c)&&!E(c);){const n=I(c),e=L(c);e||"fixed"!==n.position||(r=null),(i?!e&&!r:!e&&"static"===n.position&&r&&["absolute","fixed"].includes(r.position)||C(c)&&!e&&K(t,c))?o=o.filter((t=>t!==c)):r=n,c=q(c)}return n.set(t,o),o}(o,this._c):[].concat(r),i],a=l.reduce(((e,r)=>{const i=J(o,r,c);return e.top=n(i.top,e.top),e.right=t(i.right,e.right),e.bottom=t(i.bottom,e.bottom),e.left=n(i.left,e.left),e}),J(o,l[0],c));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},getOffsetParent:Z,getElementRects:async function(t){let{reference:n,floating:e,strategy:o}=t;const r=this.getOffsetParent||Z,i=this.getDimensions;return{reference:Q(n,await r(e),o),floating:{x:0,y:0,...await i(e)}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){return j(t)},getScale:W,isElement:P,isRTL:function(t){return"rtl"===I(t).direction}};function nt(e,r,i,c){void 0===c&&(c={});const{ancestorScroll:l=!0,ancestorResize:a=!0,elementResize:s="function"==typeof ResizeObserver,layoutShift:u="function"==typeof IntersectionObserver,animationFrame:f=!1}=c,d=V(e),m=l||a?[...d?$(d):[],...$(r)]:[];m.forEach((t=>{l&&t.addEventListener("scroll",i,{passive:!0}),a&&t.addEventListener("resize",i)}));const y=d&&u?function(e,r){let i,c=null;const l=T(e);function a(){clearTimeout(i),c&&c.disconnect(),c=null}return function s(u,f){void 0===u&&(u=!1),void 0===f&&(f=1),a();const{left:d,top:m,width:y,height:p}=e.getBoundingClientRect();if(u||r(),!y||!p)return;const h={rootMargin:-o(m)+"px "+-o(l.clientWidth-(d+y))+"px "+-o(l.clientHeight-(m+p))+"px "+-o(d)+"px",threshold:n(0,t(1,f))||1};let x=!0;function g(t){const n=t[0].intersectionRatio;if(n!==f){if(!x)return s();n?s(!1,n):i=setTimeout((()=>{s(!1,1e-7)}),100)}x=!1}try{c=new IntersectionObserver(g,{...h,root:l.ownerDocument})}catch(t){c=new IntersectionObserver(g,h)}c.observe(e)}(!0),a}(d,i):null;let p,h=-1,x=null;s&&(x=new ResizeObserver((t=>{let[n]=t;n&&n.target===d&&x&&(x.unobserve(r),cancelAnimationFrame(h),h=requestAnimationFrame((()=>{x&&x.observe(r)}))),i()})),d&&!f&&x.observe(d),x.observe(r));let g=f?_(e):null;return f&&function t(){const n=_(e);!g||n.x===g.x&&n.y===g.y&&n.width===g.width&&n.height===g.height||i(),g=n,p=requestAnimationFrame(t)}(),i(),()=>{m.forEach((t=>{l&&t.removeEventListener("scroll",i),a&&t.removeEventListener("resize",i)})),y&&y(),x&&x.disconnect(),x=null,f&&cancelAnimationFrame(p)}}const et=(t,n,e)=>{const o=new Map,r={platform:tt,...e},i={...r.platform,_c:o};return(async(t,n,e)=>{const{placement:o="bottom",strategy:r="absolute",middleware:i=[],platform:c}=e,l=i.filter(Boolean),a=await(null==c.isRTL?void 0:c.isRTL(n));let s=await c.getElementRects({reference:t,floating:n,strategy:r}),{x:u,y:f}=w(s,o,a),d=o,m={},y=0;for(let e=0;e<l.length;e++){const{name:i,fn:p}=l[e],{x:h,y:x,data:g,reset:v}=await p({x:u,y:f,initialPlacement:o,placement:d,strategy:r,middlewareData:m,rects:s,platform:c,elements:{reference:t,floating:n}});u=null!=h?h:u,f=null!=x?x:f,m={...m,[i]:{...m[i],...g}},v&&y<=50&&(y++,"object"==typeof v&&(v.placement&&(d=v.placement),v.rects&&(s=!0===v.rects?await c.getElementRects({reference:t,floating:n,strategy:r}):v.rects),({x:u,y:f}=w(s,d,a))),e=-1)}return{x:u,y:f,placement:d,strategy:r,middlewareData:m}})(t,n,{...r,platform:i})};export{nt as a,b,et as c,A as f,R as o,S as s}