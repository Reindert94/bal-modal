import{r as t,c as i,h as s,H as a,g as e}from"./p-3d62c8c0.js";import{q as o}from"./p-d46cbedf.js";import{B as n}from"./p-61996a75.js";import{b as p}from"./p-add1e9ec.js";import{s as r}from"./p-ac5a2b91.js";import{a as h,c as l,s as c,f as d,o as u,b}from"./p-c39c93c6.js";import{d as v}from"./p-fec51065.js";import{L as m}from"./p-585cea76.js";import{focusableQueryString as w}from"./p-d64b7295.js";import"./p-9a3d9e17.js";import"./p-3e8ff66b.js";import"./p-d81412d0.js";class g{showContainerElement(t){t.containerEl&&this.showElement(t.containerEl)}hideContainerElement(t){t.containerEl&&this.hideElement(t.containerEl)}showArrowElement(t,i=t.arrow){i&&t.arrowEl&&this.showElement(t.arrowEl)}hideArrowElement(t){t.arrowEl&&Object.assign(t.arrowEl.style,{left:"",top:"",display:"none",visibility:"hidden"})}showBackdropElement(t,i=t.backdrop){i&&t.backdropEl&&this.showElement(t.backdropEl)}hideBackdropElement(t){t.backdropEl&&this.hideElement(t.backdropEl)}showElement(t){t&&(t.style.setProperty("display","block"),t.style.setProperty("visibility","visible"))}hideElement(t){t&&(t.style.removeProperty("display"),t.style.removeProperty("visibility"))}}class f extends g{constructor(){super(...arguments),this.backdrop=!1,this.offset=0}async present(t){return!!(t.containerEl&&t.trigger&&t.backdropEl)&&(this.backdrop=t.getBooleanValue(t.trigger,"bal-popup-backdrop",t.backdrop),this.offset=t.getValue(t.trigger,"bal-popup-offset",t.offset),t.containerEl.style.setProperty("inset","auto 0px 0px 0px"),t.containerEl.style.setProperty("bottom",`${this.offset}px`),t.backdropEl.style.setProperty("bottom",`${this.offset}px`),this.showBackdropElement(t,this.backdrop),this.showContainerElement(t),!0)}async update(t){return!1}async dismiss(t){return!(!t.containerEl||!t.backdropEl||(t.balWillAnimate.emit(),this.hideBackdropElement(t),this.hideContainerElement(t),t.containerEl.style.removeProperty("inset"),t.containerEl.style.removeProperty("bottom"),t.backdropEl.style.removeProperty("bottom"),0))}}class y extends g{constructor(){super(...arguments),this.offset=0}async present(t){return!(!t.containerEl||!t.trigger||(this.offset=t.getValue(t.trigger,"bal-popup-offset",t.offset),t.containerEl.style.setProperty("inset",`${this.offset}px auto auto 0px`),this.offset>0&&t.containerEl.style.setProperty("box-shadow","inset var(--bal-nav-meta-bar-variant-white-shadow)"),this.showBackdropElement(t),this.showContainerElement(t),this.showArrowElement(t),0))}async update(t){return!1}async dismiss(t){return!!t.containerEl&&(this.hideBackdropElement(t),this.hideContainerElement(t),this.hideArrowElement(t),t.containerEl.style.removeProperty("box-shadow"),t.containerEl.style.removeProperty("inset"),!0)}}class x extends g{constructor(){super(...arguments),this.placement="bottom",this.offset=0,this.arrow=!1,this.backdrop=!1,this.reference=void 0,this.triggerEl=null}async present(t){if(!t.trigger&&p.hasDocument){const i=Array.from(document.querySelectorAll(`[bal-popup="${t.el.id}"]`))[0];t.trigger=i}if(t.trigger&&t.containerEl&&t.arrowEl){if(this.placement=t.getValue(t.trigger,"bal-popup-placement",t.placement),this.arrow=t.getBooleanValue(t.trigger,"bal-popup-arrow",t.arrow),this.backdrop=t.getBooleanValue(t.trigger,"bal-popup-backdrop",t.backdrop),this.reference=t.getValue(t.trigger,"bal-popup-reference",t.reference),this.offset=t.getNumberValue(t.trigger,"bal-popup-offset",t.offset),this.triggerEl=t.trigger,this.reference&&p.hasDocument){const i=document.getElementById(this.reference);this.triggerEl=i||t.trigger}if(this.triggerEl)return this.showContainerElement(t),this.showBackdropElement(t,this.backdrop),this.showArrowElement(t,this.arrow),this.triggerEl.classList.add("bal-popup-variant-popover-trigger"),"bottom-end"===this.placement&&this.triggerEl!==t.trigger&&t.setMinWidth(this.triggerEl.clientWidth),this.cleanup=h(this.triggerEl,t.containerEl,(()=>{this.update(t)})),!0}return!1}async update(t){var i,s;if(this.triggerEl&&t.trigger&&t.containerEl&&t.arrowEl){const a="bottom-end"===this.placement&&this.triggerEl!==t.trigger,e=null===(i=this.triggerEl)||void 0===i?void 0:i.getBoundingClientRect(),o=null===(s=t.trigger)||void 0===s?void 0:s.getBoundingClientRect();return l(this.triggerEl,t.containerEl,{placement:this.placement,middleware:[c(),d(),u(this.arrow?16:this.offset),b({element:t.arrowEl,padding:4})]}).then((({x:i,y:s,middlewareData:n,placement:p})=>{if(t.containerEl){Object.assign(t.containerEl.style,{left:`${i}px`,top:`${s}px`});const r={top:"bottom",right:"left",bottom:"top",left:"right"}[p.split("-")[0]];if(n.arrow&&t.arrowEl){const p=n.arrow;Object.assign(t.arrowEl.style,a?{right:e.right-o.right-4+o.width/2+"px",left:"",top:null!=s&&null!=p.y?`${p.y}px`:"",bottom:"",[r]:"-4px"}:{left:null!=i&&null!=p.x?`${p.x}px`:"",top:null!=s&&null!=p.y?`${p.y}px`:"",right:"",bottom:"",[r]:"-4px"})}}})),!0}return!1}async dismiss(t){return!!(t.containerEl&&t.arrowEl&&this.triggerEl)&&(this.cleanup&&this.cleanup(),this.triggerEl.classList.remove("bal-popup-variant-popover-trigger"),this.hideBackdropElement(t),this.hideContainerElement(t),this.hideArrowElement(t),!0)}}class k{constructor(t){this.renderer=t}async present(t){t.balWillAnimate.emit();const i=await this.renderer.present(t);return i&&(t.presented=!0,t.balDidAnimate.emit()),i}async update(t){t.balWillAnimate.emit();const i=await this.renderer.update(t);return i&&t.balDidAnimate.emit(),i}async dismiss(t){t.balWillAnimate.emit();const i=await this.renderer.dismiss(t);return i&&(t.presented=!1,t.balDidAnimate.emit()),i}}const _=class{constructor(s){t(this,s),this.balChange=i(this,"balChange",7),this.balWillAnimate=i(this,"balWillAnimate",7),this.balDidAnimate=i(this,"balDidAnimate",7),this.popupId="bal-pu-"+j++,this.isClickedOutsideOnMouseDown=!1,this.isClickedOutsideOnMouseUp=!1,this.popoverVariantRenderer=new k(new x),this.fullscreenVariantRenderer=new k(new y),this.drawerVariantRenderer=new k(new f),this.lastVariant="popover",this.initialActive=this.active,this.debouncedGlobalClick=v((t=>this.notifyGlobalClick(t)),10),this.onBackdropClick=t=>!!(this.activeBackdropDismiss&&this.presented&&t&&t.target)&&t.target.classList.contains("bal-popup__backdrop"),this.onCloseClick=()=>{this.activeClosable&&this.dismiss()},this.activeClosable=!1,this.activeBackdropDismiss=!1,this.activeVariant="popover",this.trigger=void 0,this.lastTrigger=void 0,this.minContainerWidth=0,this.label="",this.reference=void 0,this.variant="popover",this.placement="bottom",this.arrow=!1,this.backdrop=!1,this.offset=0,this.closable=!1,this.backdropDismiss=!1,this.active=!1,this.presented=!1,this.contentWidth=void 0}createLogger(t){this.log=t}async variantChanged(t,i){t!==i&&(await this.getVariantRenderer(i).dismiss(this),this.activeVariant!==t&&(this.lastVariant=this.activeVariant,this.activeVariant=t,await this.getVariantRenderer(this.lastVariant).dismiss(this)),this.presented&&await this.getVariantRenderer(t).present(this))}async activeChanged(t,i){t!==i&&t!==this.presented&&(t?this.present():this.dismiss())}contentWidthChanged(t,i){t!==i&&(void 0===t?this.el.style.removeProperty("--bal-popup-variant-popover-max-width"):this.el.style.setProperty("--bal-popup-variant-popover-max-width",`${this.contentWidth}px`))}componentDidLoad(){this.contentWidthChanged(this.contentWidth,0),!0===this.initialActive&&!0!==this.presented&&this.present()}async listenOnGlobalClick(t){var i;const s=t.target.closest("[bal-popup]");if(s&&p.hasWindow){const t=(null===(i=s.attributes.getNamedItem("bal-popup"))||void 0===i?void 0:i.nodeValue)||"";this.el.id===t&&this.debouncedGlobalClick(s)}}async listenOnKeyDown(t){this.activeClosable&&this.presented&&o(t)&&(r(t),this.dismiss())}async listenOnMouseDown(t){this.isClickedOutsideOnMouseDown=this.onBackdropClick(t)}async listenOnMouseUp(t){this.isClickedOutsideOnMouseUp=this.onBackdropClick(t)}async listenOnComponentClick(){this.presented&&this.activeBackdropDismiss&&this.isClickedOutsideOnMouseUp&&this.isClickedOutsideOnMouseDown&&await this.dismiss()}async present(){await this.resetAllVariants(),await this._present()&&(this.lastTrigger=this.trigger,this.balChange.emit(this.presented))}async dismiss(){await this.resetAllVariants(),await this._dismiss()&&(this.lastTrigger=this.trigger,this.balChange.emit(this.presented))}async toggle(){return this.presented?this.dismiss():this.present()}async setMinWidth(t){this.containerEl&&(this.containerEl.style.minWidth=`${t}px`,this.minContainerWidth=t)}async _emitChange(){this.balChange.emit(this.presented)}async _present(){p.hasDocument&&(this.lastFocus=document.activeElement||void 0),this.lastVariantRenderer&&(await this.lastVariantRenderer.dismiss(this),this.presented=!0),this.lastVariantRenderer=this.getVariantRenderer();const t=await this.lastVariantRenderer.present(this);return this.focusFirstDescendant(),t}async _dismiss(){var t;const i=await this.getVariantRenderer().dismiss(this);return this.lastVariantRenderer=void 0,this.lastFocus&&this.lastFocus.focus&&(null===(t=this.lastFocus)||void 0===t||t.focus()),i}getVariantRenderer(t=this.activeVariant){switch(t){case"fullscreen":return this.fullscreenVariantRenderer;case"drawer":return this.drawerVariantRenderer;default:return this.popoverVariantRenderer}}getValue(t,i,s){const a=t.attributes.getNamedItem(i);return a?a.value:s}getNumberValue(t,i,s){const a=t.attributes.getNamedItem(i);return a&&parseInt(a.value,10)||s}getBooleanValue(t,i,s){const a=t.attributes.getNamedItem(i);return a&&a?""===a.value||"true"===a.value:s}notifyGlobalClick(t){this.trigger=t,this.lastTrigger=void 0===this.lastTrigger?this.trigger:this.lastTrigger,this.activeVariant=this.getValue(t,"bal-popup-variant",this.variant),this.activeClosable=this.getBooleanValue(t,"bal-popup-closable",this.closable),this.activeBackdropDismiss=this.getBooleanValue(t,"bal-popup-backdrop-dismiss",this.backdropDismiss),this.presented&&this.lastTrigger!==this.trigger?(this._present(),this.lastTrigger=this.trigger):this.toggle()}async resetAllVariants(){if(await this.dismissAllOtherPopups(),this.lastVariant!==this.activeVariant){const t=this.getVariantRenderer(this.lastVariant);await t.dismiss(this)}this.lastVariant=this.activeVariant}async dismissAllOtherPopups(){if(p.hasDocument){const t=Array.from(document.getElementsByTagName("bal-popup")).filter((t=>t.id!==this.el.id&&"true"!==t.ariaHidden));for(let i=0;i<t.length;i++){const s=t[i];await s._dismiss(),await s._emitChange()}}}focusFirstDescendant(){const{el:t}=this,i=t.querySelector(w);i?i.focus():t.focus()}render(){const t=n.block("popup"),i=t.element("container"),e=t.element("arrow"),o=t.element("backdrop"),p=t.element("inner"),r=p.element("head"),h=p.element("content");return s(a,{class:Object.assign({},t.class()),role:"dialog","aria-hidden":`${!0!==this.presented}`,"aria-modal":`${!0===this.presented}`,"aria-presented":`${!0===this.presented}`,"aria-labelledby":`${this.popupId}-heading`},s("div",{class:Object.assign({},o.class()),ref:t=>this.backdropEl=t}),s("div",{class:Object.assign(Object.assign({},i.class()),i.modifier(`variant-${this.activeVariant}`).class()),ref:t=>this.containerEl=t,style:{minWidth:`${this.minContainerWidth}px`}},s("div",{class:Object.assign({},e.class()),ref:t=>this.arrowEl=t}),s("bal-stack",{layout:"vertical",px:"popover"===this.activeVariant?"medium":"none",py:"medium",class:Object.assign({},p.class())},this.label?s("bal-stack",{space:"auto",class:Object.assign({},r.class())},s("bal-heading",{"data-test":"bal-popup-label",level:"span","visual-level":"large",id:`${this.popupId}-heading`},this.label),this.activeClosable?s("bal-close",{"data-test":"bal-popup-close",tabindex:-1,onClick:()=>this.onCloseClick()}):""):"",s("div",{class:Object.assign({},h.class()),ref:t=>this.contentEl=t,"data-test":"bal-popup-content"},s("slot",null)))))}get el(){return e(this)}static get watchers(){return{variant:["variantChanged"],active:["activeChanged"],contentWidth:["contentWidthChanged"]}}};!function(t,i,s,a){var e,o=arguments.length,n=o<3?i:null===a?a=Object.getOwnPropertyDescriptor(i,s):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,i,s,a);else for(var p=t.length-1;p>=0;p--)(e=t[p])&&(n=(o<3?e(n):o>3?e(i,s,n):e(i,s))||n);o>3&&n&&Object.defineProperty(i,s,n)}([m("bal-popup")],_.prototype,"createLogger",null);let j=0;_.style={css:":root{--bal-popup-backdrop-background:rgba(0,7,57,.8);--bal-popup-container-padding-top:0;--bal-popup-container-padding-bottom:0;--bal-popup-container-background:var(--bal-color-white);--bal-popup-variant-popover-max-width:auto;--bal-popup-variant-popover-radius:var(--bal-radius-large);--bal-popup-variant-popover-shadow:var(--bal-shadow-large);--bal-popup-variant-drawer-radius:var(--bal-radius-large);--bal-popup-arrow-background:var(--bal-color-white)}.bal-popup{position:static;display:inline;z-index:var(--bal-z-index-popup)}.bal-popup__container{background:var(--bal-popup-container-background);display:none;visibility:hidden;padding-top:var(--bal-popup-container-padding-top);padding-bottom:var(--bal-popup-container-padding-bottom);-ms-flex-positive:1;flex-grow:1;margin:0 auto;position:relative;width:auto}.bal-popup__container--variant-popover{border-radius:var(--bal-popup-variant-popover-radius);-webkit-box-shadow:var(--bal-popup-variant-popover-shadow);box-shadow:var(--bal-popup-variant-popover-shadow);width:var(--bal-popup-variant-popover-max-width);position:absolute;top:0;left:0}.bal-popup__container--variant-fullscreen{position:fixed;margin:0;width:100%;min-width:100%;max-width:100% !important;min-height:var(--bal-app-height, 100%);padding-left:var(--bal-container-space);padding-right:var(--bal-container-space)}.bal-popup__container--variant-drawer{position:fixed;border-top-left-radius:var(--bal-popup-variant-drawer-radius);border-top-right-radius:var(--bal-popup-variant-drawer-radius);padding-left:var(--bal-container-space);padding-right:var(--bal-container-space);width:100%}.bal-popup__inner{overflow-y:auto;max-height:calc(var(--bal-app-height, 100%) - 8rem)}.bal-popup__inner__head{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.bal-popup__inner__content{width:100%}.bal-popup__arrow{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;width:8px;height:8px;background:var(--bal-popup-arrow-background);-webkit-transform:rotate(45deg);transform:rotate(45deg);display:none;visibility:hidden}.bal-popup__backdrop{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:fixed;bottom:0;left:0;right:0;top:0;background-color:var(--bal-popup-backdrop-background);width:100vw;display:none;visibility:hidden}.bal-popup-variant-popover-trigger,.bal-popup-permanent-trigger{z-index:calc(var(--bal-z-index-popup) + 1) !important;position:relative !important}"};export{_ as bal_popup}