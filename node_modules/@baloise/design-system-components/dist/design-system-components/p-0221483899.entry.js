import{r as t,c as s,h as i,H as e,g as h}from"./p-3d62c8c0.js";import{a as n,d as r}from"./p-560a582c.js";import{L as a}from"./p-585cea76.js";import{L as o}from"./p-4fe58c43.js";import{h as l,a as c,i as u,e as d,f,k as p,s as m,b,j,c as v,d as g,l as y}from"./p-ac5a2b91.js";import{m as k}from"./p-fec51065.js";import{i as C}from"./p-9a929c20.js";import{g as F}from"./p-97b591c9.js";import{j as w,k as x,h as O}from"./p-d46cbedf.js";import{B as $}from"./p-61996a75.js";import{d as I}from"./p-ba7c87d4.js";import{l as L}from"./p-9a3d9e17.js";import{N as B,A as P}from"./p-6238764a.js";import{l as V}from"./p-bdc4822c.js";import"./p-add1e9ec.js";import"./p-d81412d0.js";import"./p-3e8ff66b.js";var E=Object.prototype.toString,K=function(t){return function(t){return"number"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Number]"==E.call(t)}(t)&&t!=+t};const R=()=>{const t=F();return t&&t.locale||n},A=()=>w(R());function D(t){const s=parseFloat(t);return"number"==typeof s&&!K(s)}function H(t,s=0){if(""!==t&&null!=t&&!K(t)&&"-"!==t&&t!==A()&&D(t))return 0===s?parseInt(t,10):parseFloat(t)}function N(t,s=0){if(L(t))return"";t.charAt(0)===A()&&(t=`0${t}`);const i=0===s?parseInt(t,10):parseFloat(t);return K(i)?"":i.toFixed(s)}function S(t){return t.replace(".",A())}function _(t,s=0,i=""){if(L(t))return"";t.charAt(0)===A()&&(t=`0${t}`);const e=0===s?parseInt(t,10):parseFloat(t),h=""!==i?` ${i.trim()}`:"";return K(e)?"":(n=e,r=s,O(R(),n,r)+h);var n,r}var q=function(t,s,i,e){var h,n=arguments.length,r=n<3?s:null===e?e=Object.getOwnPropertyDescriptor(s,i):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,s,i,e);else for(var a=t.length-1;a>=0;a--)(h=t[a])&&(r=(n<3?h(r):n>3?h(s,i,r):h(s,i))||r);return n>3&&r&&Object.defineProperty(s,i,r),r};const z=class{constructor(i){t(this,i),this.balInput=s(this,"balInput",7),this.balChange=s(this,"balChange",7),this.balBlur=s(this,"balBlur",7),this.balFocus=s(this,"balFocus",7),this.balKeyPress=s(this,"balKeyPress",7),this.inputId="bal-number-input-"+G++,this.inheritedAttributes={},this.lastValue="",this.inputValue=this.value,this.initialValue=void 0,this.onClick=t=>l(this,t),this.handleClick=t=>c(this,t),this.onInput=()=>{var t,s;!this.nativeInput||D(s=this.nativeInput.value)||""===s||"-"===s||s===A()?(this.lastValue=(null===(t=this.nativeInput)||void 0===t?void 0:t.value)||"",this.balInput.emit(H(this.lastValue,this.decimal))):this.nativeInputValue=this.lastValue||""},this.onFocus=t=>{u(this,t),this.nativeInput&&(this.nativeInputValue=S(this.lastValue||""))},this.onBlur=t=>{d(this,t),this.nativeInput&&(this.lastValue=N(this.lastValueGetter,this.decimal),this.nativeInputValue=_(this.lastValueGetter,this.decimal,this.suffix)),this.inputValue=H(this.lastValueGetter,this.decimal),f(this)},this.onKeydown=t=>{const s=y(this),i=p(this,t),e=null==t?void 0:t.target;if(e&&!function({key:t,selectionStart:s,selectionEnd:i,newValue:e,decimal:h}){if("-"===t&&s&&s>0&&i&&i>0)return!1;if(t===A()){if(0===h)return!1;if(((e.split(A())||[]).length-1||0)>1)return!1}if(![...B,...P,A(),"-"].includes(t))return!1;if(0!==h&&e.includes(A())&&[...B].includes(t)){const t=e.split(A());if(t[t.length-1].length>h)return!1}return!0}({key:t.key,decimal:this.decimal,newValue:i,oldValue:s,selectionStart:e.selectionStart,selectionEnd:e.selectionEnd}))return m(t)},this.focused=!1,this.language=r.language,this.region=r.region,this.ariaForm=I,this.nativeInputValue="",this.inputPattern=this.createPattern(),this.name=this.inputId,this.invalid=!1,this.decimal=0,this.suffix=void 0,this.pattern=void 0,this.placeholder=void 0,this.required=!1,this.disabled=!1,this.readonly=!1,this.exactNumber=!1,this.max=void 0,this.min=void 0,this.debounce=0,this.value=void 0}createLogger(t){this.log=t}debounceChanged(){this.balChange=k(this.balChange,this.debounce)}valueChanged(t,s){if(t!==s){const s=""===t||L(t)||K(t)?this.exactNumber?"0":"":t.toString();this.inputValue=H(N(s,this.decimal),this.decimal),this.lastValue=N(s,this.decimal),this.nativeInputValue=this.focused?S(this.lastValue):_(this.lastValue,this.decimal,this.suffix)}}connectedCallback(){this.debounceChanged(),this.initialValue=this.value||0,void 0!==this.value&&this.valueChanged(this.value,void 0)}componentDidLoad(){this.inputValue=this.value}componentWillLoad(){this.inheritedAttributes=C(this.el,["aria-label","tabindex","title"])}listenOnClick(t){b(this,t)}resetHandler(t){const s=t.target;(null==s?void 0:s.contains(this.el))&&j(this,this.initialValue,this.resetHandlerTimer)}async configChanged(t){this.language=t.language,this.region=t.region,this.inputPattern=this.createPattern(),this.nativeInput&&(this.nativeInputValue=this.focused?S(this.lastValue):_(this.lastValue,this.decimal,this.suffix))}async setFocus(){v(this)}async setBlur(){g(this)}getInputElement(){return Promise.resolve(this.nativeInput)}async setAriaForm(t){this.ariaForm=Object.assign({},t)}createPattern(){if(this.pattern)return this.pattern;let t=this.suffix||"";""!==t&&(t=` ${t}`);const s=x(R());let i=A();return","===i&&(i="\\,"),`-?\\d{1,3}(?:${s}\\d{3})*(?:\\${i}\\d{1,2})?(?:${t})?`}get lastValueGetter(){return this.exactNumber&&(L(this.lastValue)||V(this.lastValue))?"0":this.lastValue}render(){const t=$.block("number-input");return i(e,{onClick:this.handleClick,"aria-disabled":this.disabled?"true":null,class:Object.assign({},t.class())},i("input",Object.assign({class:{input:!0,"is-disabled":this.disabled||this.readonly,"is-danger":this.invalid},"data-testid":"bal-number-input",ref:t=>this.nativeInput=t,id:this.ariaForm.controlId||this.inputId,"aria-labelledby":this.ariaForm.labelId,"aria-describedby":this.ariaForm.messageId,"aria-invalid":!0===this.invalid?"true":"false","aria-disabled":this.disabled?"true":null,name:this.name,disabled:this.disabled,placeholder:this.placeholder||"",readonly:this.readonly,required:this.required,pattern:this.inputPattern,min:this.min,max:this.max,value:this.nativeInputValue,onInput:t=>this.onInput(t),onFocus:t=>this.onFocus(t),onBlur:t=>this.onBlur(t),onClick:this.onClick,onKeyDown:t=>this.onKeydown(t),onKeyPress:t=>this.balKeyPress.emit(t)},this.inheritedAttributes)))}get el(){return h(this)}static get watchers(){return{debounce:["debounceChanged"],value:["valueChanged"]}}};q([a("bal-number-input")],z.prototype,"createLogger",null),q([o()],z.prototype,"configChanged",null);let G=0;z.style={css:".bal-number-input{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:block;position:relative;-ms-flex:1;flex:1;-ms-flex-align:center;align-items:center;width:100%;padding:0;font-family:var(--bal-font-family-text)}"};export{z as bal_number_input}